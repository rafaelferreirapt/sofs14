<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>SOFS14: sofs_ifuncs_2.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SOFS14
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">FUSE based file system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sofs__ifuncs__2_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sofs_ifuncs_2.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Set of operations to manage inodes: level 2 of the internal file system organization.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="sofs__inode_8h_source.html">sofs_inode.h</a>&quot;</code><br/>
</div>
<p><a href="sofs__ifuncs__2_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4cfb6a601857f6df85b22cf3971300dd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4cfb6a601857f6df85b22cf3971300dd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a4cfb6a601857f6df85b22cf3971300dd">IUIN</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a4cfb6a601857f6df85b22cf3971300dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">inode in use status <br/></td></tr>
<tr class="separator:a4cfb6a601857f6df85b22cf3971300dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f481854b4f492803a20c275df14ddc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad4f481854b4f492803a20c275df14ddc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#ad4f481854b4f492803a20c275df14ddc">FDIN</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ad4f481854b4f492803a20c275df14ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">free inode in dirty state status <br/></td></tr>
<tr class="separator:ad4f481854b4f492803a20c275df14ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c71a5e59a53413cd6c270266d63b031"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c71a5e59a53413cd6c270266d63b031"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a5c71a5e59a53413cd6c270266d63b031">R</a>&#160;&#160;&#160;0x0004</td></tr>
<tr class="memdesc:a5c71a5e59a53413cd6c270266d63b031"><td class="mdescLeft">&#160;</td><td class="mdescRight">performing a read operation <br/></td></tr>
<tr class="separator:a5c71a5e59a53413cd6c270266d63b031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649b8f01fd6c0f47ff3cbddaeba63bfb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a649b8f01fd6c0f47ff3cbddaeba63bfb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a649b8f01fd6c0f47ff3cbddaeba63bfb">W</a>&#160;&#160;&#160;0x0002</td></tr>
<tr class="memdesc:a649b8f01fd6c0f47ff3cbddaeba63bfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">performing a write operation <br/></td></tr>
<tr class="separator:a649b8f01fd6c0f47ff3cbddaeba63bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207fd5507206d307cd63f95374fcd00d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a207fd5507206d307cd63f95374fcd00d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a207fd5507206d307cd63f95374fcd00d">X</a>&#160;&#160;&#160;0x0001</td></tr>
<tr class="memdesc:a207fd5507206d307cd63f95374fcd00d"><td class="mdescLeft">&#160;</td><td class="mdescRight">performing an execute operation <br/></td></tr>
<tr class="separator:a207fd5507206d307cd63f95374fcd00d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a224ca63a9e45adfbd33c22c34446bd86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a224ca63a9e45adfbd33c22c34446bd86">soReadInode</a> (<a class="el" href="sofs__inode_8h.html#ac75a291739fb635e97b7928ceb4fba6a">SOInode</a> *p_inode, uint32_t nInode, uint32_t status)</td></tr>
<tr class="memdesc:a224ca63a9e45adfbd33c22c34446bd86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read specific inode data from the table of inodes.  <a href="#a224ca63a9e45adfbd33c22c34446bd86">More...</a><br/></td></tr>
<tr class="separator:a224ca63a9e45adfbd33c22c34446bd86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d919d7f37210bd618ffe9b3f3acd094"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a4d919d7f37210bd618ffe9b3f3acd094">soWriteInode</a> (<a class="el" href="sofs__inode_8h.html#ac75a291739fb635e97b7928ceb4fba6a">SOInode</a> *p_inode, uint32_t nInode, uint32_t status)</td></tr>
<tr class="memdesc:a4d919d7f37210bd618ffe9b3f3acd094"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write specific inode data to the table of inodes.  <a href="#a4d919d7f37210bd618ffe9b3f3acd094">More...</a><br/></td></tr>
<tr class="separator:a4d919d7f37210bd618ffe9b3f3acd094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a943e25f7bb8993066202df65ea0406f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a943e25f7bb8993066202df65ea0406f4">soCleanInode</a> (uint32_t nInode)</td></tr>
<tr class="memdesc:a943e25f7bb8993066202df65ea0406f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean an inode.  <a href="#a943e25f7bb8993066202df65ea0406f4">More...</a><br/></td></tr>
<tr class="separator:a943e25f7bb8993066202df65ea0406f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a143cbbf658e9ed50657ebdd13d2eb832"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__ifuncs__2_8h.html#a143cbbf658e9ed50657ebdd13d2eb832">soAccessGranted</a> (uint32_t nInode, uint32_t opRequested)</td></tr>
<tr class="memdesc:a143cbbf658e9ed50657ebdd13d2eb832"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the inode access rights against a given operation.  <a href="#a143cbbf658e9ed50657ebdd13d2eb832">More...</a><br/></td></tr>
<tr class="separator:a143cbbf658e9ed50657ebdd13d2eb832"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Set of operations to manage inodes: level 2 of the internal file system organization. </p>
<p>(interface file) </p>
<pre class="fragment">  The aim is to provide an unique description of the functions that operate at this level.
</pre><p>The operations are: </p>
<ul>
<li>read specific inode data from the table of inodes </li>
<li>write specific inode data to the table of inodes </li>
<li>clean an inode </li>
<li>check the inode access permissions against a given operation.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Artur Carneiro Pereira September 2008 </dd>
<dd>
Miguel Oliveira e Silva September 2009 </dd>
<dd>
Ant√≥nio Rui Borges - September 2010 / September 2011, September 2014</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>In case an error occurs, all functions return a negative value which is the symmetric of the system error or the local error that better represents the error cause. Local errors are out of the range of the system errors. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a143cbbf658e9ed50657ebdd13d2eb832"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soAccessGranted </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nInode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>opRequested</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the inode access rights against a given operation. </p>
<p>The inode must to be in use and belong to one of the legal file types. It checks if the inode mask permissions allow a given operation to be performed.</p>
<p>When the calling process is <em>root</em>, access to reading and/or writing is always allowed and access to execution is allowed provided that either <em>user</em>, <em>group</em> or <em>other</em> have got execution permission.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nInode</td><td>number of the inode </td></tr>
    <tr><td class="paramname">opRequested</td><td>operation to be performed: a bitwise combination of R, W, and X</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0 (zero)</code>, on success </dd>
<dd>
-<code>EINVAL</code>, if <em>buffer pointer</em> is <code>NULL</code> or no operation of the defined class is described </dd>
<dd>
-<code>EACCES</code>, if the operation is denied </dd>
<dd>
-<code>EIUININVAL</code>, if the inode in use is inconsistent </dd>
<dd>
-<code>ELDCININVAL</code>, if the list of data cluster references belonging to an inode is inconsistent </dd>
<dd>
-<code>EDCINVAL</code>, if the data cluster header is inconsistent </dd>
<dd>
-<code>EBADF</code>, if the device is not already opened </dd>
<dd>
-<code>EIO</code>, if it fails reading or writing </dd>
<dd>
-<code>ELIBBAD</code>, if some kind of inconsistency was detected at some internal storage lower level </dd>
<dd>
-<em>other specific error</em> issued by <em>lseek</em> system call </dd></dl>

</div>
</div>
<a class="anchor" id="a943e25f7bb8993066202df65ea0406f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soCleanInode </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nInode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean an inode. </p>
<p>The inode must be free in the dirty state. The inode is supposed to be associated to a file, a directory, or a symbolic link which was previously deleted.</p>
<p>This function cleans the list of data cluster references.</p>
<p>Notice that the inode 0, supposed to belong to the file system root directory, can not be cleaned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nInode</td><td>number of the inode</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0 (zero)</code>, on success </dd>
<dd>
-<code>EINVAL</code>, if the <em>inode number</em> is out of range </dd>
<dd>
-<code>EFDININVAL</code>, if the free inode in the dirty state is inconsistent </dd>
<dd>
-<code>ELDCININVAL</code>, if the list of data cluster references belonging to an inode is inconsistent </dd>
<dd>
-<code>EDCINVAL</code>, if the data cluster header is inconsistent </dd>
<dd>
-<code>EWGINODENB</code>, if the <em>inode number</em> in the data cluster <code>status</code> field is different from the provided <em>inode number</em> (FREE AND CLEAN / CLEAN) </dd>
<dd>
-<code>ELIBBAD</code>, if some kind of inconsistency was detected at some internal storage lower level </dd>
<dd>
-<code>EBADF</code>, if the device is not already opened </dd>
<dd>
-<code>EIO</code>, if it fails reading or writing </dd>
<dd>
-<em>other specific error</em> issued by <em>lseek</em> system call </dd></dl>

</div>
</div>
<a class="anchor" id="a224ca63a9e45adfbd33c22c34446bd86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soReadInode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sofs__inode_8h.html#ac75a291739fb635e97b7928ceb4fba6a">SOInode</a> *&#160;</td>
          <td class="paramname"><em>p_inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nInode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read specific inode data from the table of inodes. </p>
<p>The inode may be either in use and belong to one of the legal file types or be free in the dirty state. Upon reading, the <em>time of last file access</em> field is set to current time, if the inode is in use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_inode</td><td>pointer to the buffer where inode data must be read into </td></tr>
    <tr><td class="paramname">nInode</td><td>number of the inode to be read from </td></tr>
    <tr><td class="paramname">status</td><td>inode status (in use / free in the dirty state)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0 (zero)</code>, on success </dd>
<dd>
-<code>EINVAL</code>, if the <em>buffer pointer</em> is <code>NULL</code> or the <em>inode number</em> is out of range or the inode status is invalid </dd>
<dd>
-<code>EIUININVAL</code>, if the inode in use is inconsistent </dd>
<dd>
-<code>EFDININVAL</code>, if the free inode in the dirty state is inconsistent </dd>
<dd>
-<code>ELDCININVAL</code>, if the list of data cluster references belonging to an inode is inconsistent </dd>
<dd>
-<code>EDCINVAL</code>, if the data cluster header is inconsistent </dd>
<dd>
-<code>ELIBBAD</code>, if some kind of inconsistency was detected at some internal storage lower level </dd>
<dd>
-<code>EBADF</code>, if the device is not already opened </dd>
<dd>
-<code>EIO</code>, if it fails reading or writing </dd>
<dd>
-<em>other specific error</em> issued by <em>lseek</em> system call </dd></dl>

</div>
</div>
<a class="anchor" id="a4d919d7f37210bd618ffe9b3f3acd094"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soWriteInode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sofs__inode_8h.html#ac75a291739fb635e97b7928ceb4fba6a">SOInode</a> *&#160;</td>
          <td class="paramname"><em>p_inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nInode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write specific inode data to the table of inodes. </p>
<p>The inode may be either in use and belong to one of the legal file types or be free in the dirty state. Upon writing, the <em>time of last file modification</em> and <em>time of last file access</em> fields are set to current time, if the inode is in use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_inode</td><td>pointer to the buffer containing the data to be written from </td></tr>
    <tr><td class="paramname">nInode</td><td>number of the inode to be written into </td></tr>
    <tr><td class="paramname">status</td><td>inode status (in use / free in the dirty state)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0 (zero)</code>, on success </dd>
<dd>
-<code>EINVAL</code>, if the <em>buffer pointer</em> is <code>NULL</code> or the <em>inode number</em> is out of range or the inode status is invalid </dd>
<dd>
-<code>EIUININVAL</code>, if the inode in use is inconsistent </dd>
<dd>
-<code>EFDININVAL</code>, if the free inode in the dirty state is inconsistent </dd>
<dd>
-<code>ELDCININVAL</code>, if the list of data cluster references belonging to an inode is inconsistent </dd>
<dd>
-<code>EDCINVAL</code>, if the data cluster header is inconsistent </dd>
<dd>
-<code>ELIBBAD</code>, if some kind of inconsistency was detected at some internal storage lower level </dd>
<dd>
-<code>EBADF</code>, if the device is not already opened </dd>
<dd>
-<code>EIO</code>, if it fails reading or writing </dd>
<dd>
-<em>other specific error</em> issued by <em>lseek</em> system call </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_41b98d4f55b8bea9fa3fea214b895971.html">sofs14</a></li><li class="navelem"><a class="el" href="sofs__ifuncs__2_8h.html">sofs_ifuncs_2.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
